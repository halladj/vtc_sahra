{
    "info": {
        "name": "vtc-sahra",
        "description": "Complete API collection for VTC Sahra ride-hailing platform with wallet, gift cards, and payment integration",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:5000/api",
            "type": "string"
        },
        {
            "key": "passengerToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "driverToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "adminToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "rideId",
            "value": "",
            "type": "string"
        },
        {
            "key": "vehicleId",
            "value": "",
            "type": "string"
        }
    ],
    "item": [
        {
            "name": "Authentication",
            "item": [
                {
                    "name": "Register User",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"newuser@vtc.dz\",\n  \"password\": \"password123\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"phoneNumber\": \"+213555000099\",\n  \"address\": \"123 Main Street\",\n  \"wilaya\": \"Algiers\",\n  \"commune\": \"Hydra\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/register",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "register"
                            ]
                        },
                        "description": "Register a new user. Automatically creates a wallet with 0 balance."
                    }
                },
                {
                    "name": "Register Driver",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"newdriver@vtc.dz\",\n  \"password\": \"password123\",\n  \"firstName\": \"Ahmed\",\n  \"lastName\": \"Driver\",\n  \"phoneNumber\": \"+213555000088\",\n  \"address\": \"456 Driver Ave\",\n  \"wilaya\": \"Oran\",\n  \"commune\": \"Es Senia\",\n  \"vehicleType\": \"CAR\",\n  \"vehicleModel\": \"Renault Symbol\",\n  \"vehicleYear\": 2021,\n  \"vehiclePlate\": \"16-1234-16\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/register-driver",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "register-driver"
                            ]
                        },
                        "description": "Register a new driver with vehicle. Automatically creates a wallet."
                    }
                },
                {
                    "name": "Login (Passenger)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "const response = pm.response.json();",
                                    "if (response.accessToken) {",
                                    "    pm.collectionVariables.set('passengerToken', response.accessToken);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"user1@vtc.dz\",\n  \"password\": \"password123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login as passenger. Token saved to passengerToken variable."
                    }
                },
                {
                    "name": "Login (Driver)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "const response = pm.response.json();",
                                    "if (response.accessToken) {",
                                    "    pm.collectionVariables.set('driverToken', response.accessToken);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"driver1@vtc.dz\",\n  \"password\": \"password123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login as driver. Token saved to driverToken variable."
                    }
                },
                {
                    "name": "Login (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "const response = pm.response.json();",
                                    "if (response.accessToken) {",
                                    "    pm.collectionVariables.set('adminToken', response.accessToken);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"admin@vtc.dz\",\n  \"password\": \"password123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login as admin. Token saved to adminToken variable."
                    }
                }
            ]
        },
        {
            "name": "Wallet",
            "item": [
                {
                    "name": "Get My Wallet",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/wallet",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "wallet"
                            ]
                        },
                        "description": "Get authenticated user's wallet with balance and transaction history"
                    }
                },
                {
                    "name": "Get Transaction History",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/wallet/transactions",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "wallet",
                                "transactions"
                            ]
                        },
                        "description": "Get all transactions for authenticated user's wallet"
                    }
                },
                {
                    "name": "Credit Wallet (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{adminToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"userId\": \"user-id-here\",\n  \"amount\": 50000,\n  \"reference\": \"Admin top-up\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/wallet/credit",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "wallet",
                                "credit"
                            ]
                        },
                        "description": "Credit a user's wallet (Admin only). Amount in cents (50000 = 500 DA)"
                    }
                },
                {
                    "name": "Debit Wallet (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{adminToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"userId\": \"user-id-here\",\n  \"amount\": 10000,\n  \"reference\": \"Admin deduction\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/wallet/debit",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "wallet",
                                "debit"
                            ]
                        },
                        "description": "Debit a user's wallet (Admin only). Amount in cents (10000 = 100 DA)"
                    }
                }
            ]
        },
        {
            "name": "Gift Cards",
            "item": [
                {
                    "name": "Create Gift Card (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{adminToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"amount\": 100000,\n  \"code\": \"GIFT-CUSTOM-2024\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/giftcards",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "giftcards"
                            ]
                        },
                        "description": "Create a gift card (Admin only). Code is optional - auto-generated if not provided. Amount in cents."
                    }
                },
                {
                    "name": "Get All Gift Cards (Admin)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{adminToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/giftcards",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "giftcards"
                            ]
                        },
                        "description": "Get all gift cards (Admin only). Shows unused cards first."
                    }
                },
                {
                    "name": "Get Gift Card by Code (Admin)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{adminToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/giftcards/GIFT-1000-ABC123",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "giftcards",
                                "GIFT-1000-ABC123"
                            ]
                        },
                        "description": "Get specific gift card details (Admin only)"
                    }
                },
                {
                    "name": "Redeem Gift Card",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"code\": \"GIFT-1000-ABC123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/giftcards/redeem",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "giftcards",
                                "redeem"
                            ]
                        },
                        "description": "Redeem a gift card. Credits the authenticated user's wallet."
                    }
                }
            ]
        },
        {
            "name": "Rides",
            "item": [
                {
                    "name": "Create Ride",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    const response = pm.response.json();",
                                    "    pm.collectionVariables.set('rideId', response.id);",
                                    "    pm.test('Ride created successfully', function() {",
                                    "        pm.expect(response.status).to.equal('PENDING');",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"type\": \"REGULAR\",\n  \"origin\": \"123 Main Street, Algiers\",\n  \"destination\": \"456 Park Avenue, Oran\",\n  \"distanceKm\": 10.5,\n  \"durationMin\": 25,\n  \"price\": 50000\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/rides",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides"
                            ]
                        },
                        "description": "Create a new ride request. Price in cents (50000 = 500 DA). Requires authentication."
                    }
                },
                {
                    "name": "Get Pending Rides (Driver)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/pending",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "pending"
                            ]
                        },
                        "description": "Get all pending rides available for drivers to accept. Requires DRIVER role."
                    }
                },
                {
                    "name": "Get My Rides (Passenger)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/user?status=PENDING",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "user"
                            ],
                            "query": [
                                {
                                    "key": "status",
                                    "value": "PENDING",
                                    "description": "Optional: PENDING, ACCEPTED, ONGOING, COMPLETED, CANCELLED"
                                }
                            ]
                        },
                        "description": "Get all rides for authenticated user (as passenger)."
                    }
                },
                {
                    "name": "Get My Rides (Driver)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/driver",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "driver"
                            ]
                        },
                        "description": "Get all rides for the authenticated driver. Requires DRIVER role."
                    }
                },
                {
                    "name": "Get Ride Details",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}"
                            ]
                        },
                        "description": "Get details of a specific ride. Only accessible by passenger or driver of the ride."
                    }
                },
                {
                    "name": "Accept Ride (Driver)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    pm.test('Ride accepted successfully', function() {",
                                    "        pm.expect(response.status).to.equal('ACCEPTED');",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"vehicleId\": \"{{vehicleId}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}/accept",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}",
                                "accept"
                            ]
                        },
                        "description": "Accept a pending ride. Requires DRIVER role and valid vehicleId."
                    }
                },
                {
                    "name": "Start Ride (ONGOING)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"status\": \"ONGOING\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}/status",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}",
                                "status"
                            ]
                        },
                        "description": "Start an accepted ride by updating status to ONGOING."
                    }
                },
                {
                    "name": "Complete Ride (Process Payment)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            },
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"status\": \"COMPLETED\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}/status",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}",
                                "status"
                            ]
                        },
                        "description": "Complete ride. Debits passenger, credits driver (minus 15% commission). Returns 402 if insufficient balance."
                    }
                },
                {
                    "name": "Cancel Ride (Passenger)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{passengerToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}/cancel",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}",
                                "cancel"
                            ]
                        },
                        "description": "Cancel a ride as passenger. No penalty. Cannot cancel completed rides."
                    }
                },
                {
                    "name": "Cancel Ride (Driver - with Penalty)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "Bearer {{driverToken}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/rides/{{rideId}}/cancel",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "rides",
                                "{{rideId}}",
                                "cancel"
                            ]
                        },
                        "description": "Cancel a ride as driver. Incurs 10% penalty if ride is ACCEPTED or ONGOING."
                    }
                }
            ]
        }
    ]
}